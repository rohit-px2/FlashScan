<html>
  <head>
    <title>Upload</title>
  </head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
  <script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
			  crossorigin="anonymous"></script>
  <body>
    <form id="uploadForm" enctype="multipart/form-data" method="POST">
      <input id="images" type="file" accept="image/x-png,image/jpeg" multiple>
      <br>
      <button type="submit">Submit</button>
    </form>
    <script>
      const toBase64 = file => new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = () => resolve(reader.result);
          reader.onerror = error => reject(error);
      });

      let f = document.getElementById("uploadForm")
      const id = window.location.href.split("/")[3]
      f.action=`/image/${id}`
      f.addEventListener("submit", async event => {
        event.preventDefault()
        var input = document.getElementById("images")
        var files = input.files
        const url = `/image/${id}`
        for(let i = 0; i < files.length; i++) {
          const img = await toBase64(files.item(i))
          console.log(typeof(img))
          console.log(img)
          const response = await fetch(url, {
            method: 'POST',
            mode: 'cors',
            headers: {
              'Accept': "application/json",
              'Content-Type': "application/json"
            },
            cache: 'no-cache',
            credentials: 'same-origin',
            body: JSON.stringify({
              data: img
            })
          })
        }
      })
    </script>
  </body>
</html>